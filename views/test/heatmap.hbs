<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azure Maps Heatmap - Priority by Color</title>
    <script src="https://atlas.microsoft.com/sdk/javascript/mapcontrol/2/atlas.min.js"></script>
    <link href="https://atlas.microsoft.com/sdk/javascript/mapcontrol/2/atlas.min.css" rel="stylesheet" />
    <style>
        #map-container {
            width: 100%;
            height: 100vh;
        }
    </style>
</head>
<body>
    <div id="map-container"></div>
    <script>
        // Initialize the Azure Map
        const map = new atlas.Map('map-container', {
            center: [105.854444, 21.028511], // Center on Hanoi, Vietnam
            zoom: 4, // Adjusted zoom to cover the entire Vietnam
            authOptions: {
                authType: 'subscriptionKey',
                subscriptionKey: '9CK5vUwgBEPIqMa2ReEXCeYlWGSkZEZ1wdWHtlZd9UHj8aUtVAwWJQQJ99AKACYeBjFx5reYAAAgAZMP1zkp' // Replace with your Azure Maps subscription key
            }
        });

        // GeoJSON data with priority levels (0 = low, 100 = high priority)
        const geoJsonData = {
            type: "FeatureCollection",
            features: [
                {
                    type: "Feature",
                    geometry: { type: "Point", coordinates: [106.660172, 10.762622] }, // Ho Chi Minh City
                    properties: { priority: 20 } // High priority
                },
                {
                    type: "Feature",
                    geometry: { type: "Point", coordinates: [105.854444, 21.028511] }, // Hanoi
                    properties: { priority: 20 } // Medium priority
                },
                {
                    type: "Feature",
                    geometry: { type: "Point", coordinates: [108.211830, 16.047079] }, // Da Nang
                    properties: { priority: 10 } // Medium priority
                },
                {
                    type: "Feature",
                    geometry: { type: "Point", coordinates: [109.196749, 12.238791] }, // Nha Trang
                    properties: { priority: 20 } // Low priority
                },
                {
                    type: "Feature",
                    geometry: { type: "Point", coordinates: [105.927704, 9.848247] }, // Can Tho
                    properties: { priority: 10 } // Very low priority
                },
                // Additional cities with varying priorities
                {
                    type: "Feature",
                    geometry: { type: "Point", coordinates: [104.9389, 11.7595] }, // Phan Thiet
                    properties: { priority: 10 }
                },
                {
                    type: "Feature",
                    geometry: { type: "Point", coordinates: [106.8181, 10.4936] }, // Bien Hoa
                    properties: { priority: 5 }
                }
            ]
        };

        // Add a heatmap layer once the map is ready
        map.events.add('ready', () => {
            const dataSource = new atlas.source.DataSource();
            dataSource.add(geoJsonData);
            map.sources.add(dataSource);

            const heatmapLayer = new atlas.layer.HeatMapLayer(dataSource, null, {
                weight: ['get', 'priority'], // Use 'priority' property for intensity
                radius: 20, // Radius of influence in pixels
                intensity: 1.0, // Overall intensity of the heatmap
            });
            map.layers.add(heatmapLayer);
        });
    </script>
</body>
</html>
